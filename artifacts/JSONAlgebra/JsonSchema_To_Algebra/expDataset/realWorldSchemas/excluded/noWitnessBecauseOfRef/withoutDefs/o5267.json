{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Settings of the acoustic system",
    "description": "Settings file for the acoustic system describing the sample space, beam and topology.\nSchema on github: https://github.com/Engineer2B/PowerCalculator-Schemas",
    "type": "object",
    "required": [
        "Sampling",
        "System"
    ],
    "properties": {
        "Sampling": {
            "type": "object",
            "description": "Settings of the sampling space.",
            "required": [
                "LatticeSpacing",
                "LatticeExtrema",
                "RaysPerElement",
                "PowerLimit",
                "ThetaMax"
            ],
            "properties": {
                "LatticeSpacing": {
                    "description": "Spacing between points inside the lattice box in [m, m, m].",
                    "$ref": "#Vector"
                },
                "LatticeExtrema": {
                    "type": "object",
                    "description": "Minimal and maximal values that describe the lattice box in [m].",
                    "required": [
                        "X",
                        "Y",
                        "Z"
                    ],
                    "properties": {
                        "X": {
                            "description": "Minimal and maximal X values of the box in [m].",
                            "$ref": "#Extremum"
                        },
                        "Y": {
                            "description": "Minimal and maximal Y values of the box in [m].",
                            "$ref": "#Extremum"
                        },
                        "Z": {
                            "description": "Minimal and maximal Z values of the box in [m].",
                            "$ref": "#Extremum"
                        }
                    }
                },
                "RaysPerElement": {
                    "type": "integer",
                    "description": "Number of rays per transducer element.",
                    "minimum": 1
                },
                "PowerLimit": {
                    "type": "number",
                    "description": "If the power of the ray goes below this limit in [W], no new rays can be generated from the ray.",
                    "exclusiveMinimum": 0
                },
                "ThetaMax": {
                    "type": "number",
                    "description": "Maximal angle up to which rays are generated by the transducer elements in [rad]. Theta is defined for each individual transducer element as the angle between the direction of the element and the plane in which it lies.",
                    "exclusiveMinimum": 0,
                    "maximum": 1.5707963267948966
                }
            }
        },
        "System": {
            "type": "object",
            "description": "Settings of the system configuration.",
            "required": [
                "ObjectTransformation",
                "TransducerSettings"
            ],
            "properties": {
                "ObjectTransformation": {
                    "description": "Transformation applied to the object.",
                    "$ref": "#Transformation"
                },
                "TransducerSettings": {
                    "type": "object",
                    "required": [
                        "Focus",
                        "Power",
                        "Frequency",
                        "TrajectoryInterval",
                        "SonicationTiming",
                        "ImagingTiming"
                    ],
                    "description": "Settings of the transducer.",
                    "properties": {
                        "Focus": {
                            "description": "Position towards which the focus is phase-shifted in [m, m, m].",
                            "items": {
                                "$ref": "#Vector"
                            }
                        },
                        "Power": {
                            "type": "number",
                            "description": "Total amount of power that the transducer sends out in [W].",
                            "exclusiveMinimum": 0
                        },
                        "Frequency": {
                            "type": "number",
                            "description": "Frequency at which the transducer elements oscillate in [Hz].",
                            "exclusiveMinimum": 0
                        },
                        "TrajectoryInterval": {
                            "type": "number",
                            "description": "Duration for which a focus is sonicated in [s].",
                            "exclusiveMinimum": 0
                        },
                        "SonicationTiming": {
                            "$ref": "#Extremum",
                            "description": "The timeframe accross which sonication occurs in [s]."
                        },
                        "ImagingTiming": {
                            "$ref": "#Extremum",
                            "description": "The timeframe accross which imaging occurs in [s]."
                        }
                    }
                }
            }
        }
    },
    "Extremum": {
        "$id": "#Extremum",
        "properties": {
            "Min": {
                "type": "number",
                "description": "The minimimal value."
            },
            "Max": {
                "type": "number",
                "description": "The maximal value."
            }
        }
    },
    "Vector": {
        "$id": "#Vector",
        "type": "array",
        "maxItems": 3,
        "minItems": 3,
        "items": {
            "type": "number"
        }
    },
    "Transformation": {
        "$id": "#Transformation",
        "required": [
            "Inclination",
            "Azimuth",
            "ScaleFactor",
            "Translation"
        ],
        "properties": {
            "Inclination": {
                "type": "number",
                "description": "X or Y axis rotation angle in radians."
            },
            "Azimuth": {
                "type": "number",
                "description": "Z axis rotation angle in radians."
            },
            "ScaleFactor": {
                "type": "number",
                "description": "Scalar multiplier."
            },
            "Translation": {
                "description": "Vector of translation in [m, m, m] (if ScaleFactor is 1).",
                "$ref": "#Vector"
            }
        }
    }
}